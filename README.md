# Pixelfed helm chart
<a href="https://github.com/small-hack/pixelfed-chart/releases"><img src="https://img.shields.io/github/v/release/small-hack/pixelfed-chart?style=plastic&labelColor=blue&color=green&logo=GitHub&logoColor=white"></a><br />

A helm chart to setup [Pixelfed](https://github.com/pixelfed/pixelfed), a federated social media app focused on photos.

This chart is still in a testing phase and may not be fully stable yet.

Uses @mattlqx's [docker image](https://ghcr.io/mattlqx/docker-pixelfed) which is for now pinned to a specific nightly build of the upstream `dev` branch of the official pixelfed repo. You may want to set `image.tag="dev-nginx"` (built from the top of the pixelfed repo's dev branch nightly, so it always has the latest version of pixelfed - but maybe buggy) as it may solve issues you are having that are already fixed such as this [bug that was already patched](https://github.com/pixelfed/pixelfed/issues/5220#issuecomment-2599854479).

## Features

- helm parameter ([`values.yaml`](./charts/pixelfed/values.yaml)) docs autogenerated using [`helm-docs`](https://github.com/norwoodj/helm-docs) in [`README.md`](./charts/pixelfed/README.md)
- includes bitnami subcharts for [valkey](https://github.com/bitnami/charts/blob/main/bitnami/valkey/README.md#parameters) (redis) and [postgresql](https://github.com/bitnami/charts/blob/main/bitnami/postgresql/README.md#parameters) (database)
  - but you can also bring your own Valkey, Redis, or Postgresql database
  - we're also looking for anyone who wants to test the mariadb subchart
- use existing Kubernetes Secrets for Valkey, PostgreSQL, and mail (SMTP)
- configurable liveness and readiness probes (or none at all)
- configurable tolerations, affinity, and nodeselectors
- configurable persistence with a PVC we create, or bring your own
  - use extra volumes, volumemounts
- Add sidecar containers or initContainers
- RenovateBot keeps the subcharts and docker image up to date
- The chart is linted and a test install is run on every pull request via a GitHub Workflow

## TLDR

```bash
# add the chart repo to your helm repos
helm repo add pixelfed https://small-hack.github.io/pixelfed-chart

# download the values.yaml and edit it with your own values such as YOUR hostname
# especially important are pixelfed.app.domain and pixelfed.mail settings
helm show values pixelfed/pixelfed > values.yaml

# install the chart
helm install --namespace pixelfed --create-namespace pixelfed/pixelfed --values values.yaml
```

## Notes

You can find some of the general Pixelfed configuration docs here:

https://docs.pixelfed.org/running-pixelfed/installation.html

But you'll find additional configuration here:

https://github.com/pixelfed/pixelfed/blob/dev/.env.docker

### Creating your first user

```console
$ kubectl exec -it YOUR_PIXELFED_POD -- /bin/bash -c "php artisan user:create --name=myname --username=myusername --email=myname@example.tld --password=password --is_admin=false --confirm_email=true"
```

## Contibuting

### Bugs and other Issues

If you have a bug to report or a feature to request, you can first search the GitHub Issues, and if you can't find what you're looking for, feel free to open an Issue.

### Contributing to the Code

We're always happy to review a pull request :) Please check out the [contributing doc](CONTRIBUTING.md).
